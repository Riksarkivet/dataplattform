<!doctype html>

<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="Shortcut Icon" sizes="16x16 24x24 32x32 64x64" href="https://www.riksarkivet.se/Administration/Images/Icons/janus.ico">
	<link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/open-iconic/1.1.1/font/css/open-iconic.min.css" integrity="sha512-LeCmts7kEi09nKc+DwGJqDV+dNQi/W8/qb0oUSsBLzTYiBwxj0KBlAow2//jV7jwEHwSCPShRN2+IWwWcn1x7Q==" crossorigin="anonymous" referrerpolicy="no-referrer" />
	<link rel="stylesheet" href="/css/ra-examples.css">
	<script src="https://unpkg.com/alpinejs" defer></script>
	<script src="/js/ra-examples.js"></script>
</head>

<body x-data="
	{ 
		loading: false,
		image: {
			present: false
		}
	}
">
	<main class="container">
		<h1>Riksarkivets API-er</h1>

		<article>
			<h2>Exempel - IIIF Collections</h2>
			<p>
				Detta exempel visar hur man kan bl채ddra i Riksarkivets digitiserade arkivhandlingar med hj채lp av 
				<a href="https://iiif.io/api/presentation/3.0/">IIIF Presentation API</a>.
			</p>

			<article 
				x-data="
					{ 
						collection: null,
						trail: []
					}
				" 
				x-init="
					url = collectionUrl();
					loading = true;
					collection = await getCollection(url);
					loading = false;
				"
			>
				<details>
					<summary>
						<strong x-text="collection?.label?.sv[0]"></strong>
					</summary>
					<p x-text="collection?.summary?.sv[0]"></p>
					<ul>
						<template x-for="(prev, index) in trail" :key="prev.id">
							<li 
								class="link" 
								x-data="
									{ 
										presentation: `${prev.label} <span class='oi' data-glyph='arrow-left' title='Arrow left' aria-hidden='true'></span>`
									}
								" 
								x-on:click="
									ancestor = trail[index];
									trail = trail.slice(0, index);
									loading = true;
									collection = await getCollection(ancestor.id)
									loading = false;
								"
							>
								<span x-html="presentation"></span>
							</li>
						</template>
					</ul>
					<hr>
					<ul>
						<template x-for="item in collection?.items" :key="item.id">
							<li 
								class="link" 
								x-data="
									{ 
										presentation: itemLink(item) 
									}
								"
								x-on:click="
									console.log(`--- Item type: ${item.type}`);
									if (item.type === 'Collection') {
										trail.push({
											id: collection.id,
											label: collection.label.sv[0]
										});
										collection = await getCollection(item.id)
									} else {
										image.present = true;
										image.id = item.id
									}
								"
							>
								<span x-html="presentation"></span>
							</li>
						</template>
					</ul>
				</details>
			</article>
		</article>
	</main>
	<dialog x-bind:open="loading">
		<article>
			<p aria-busy="true">Arbete p책g책r...</p>
		</article>
	</dialog>
	<dialog x-bind:open="image.present">
		<article>
			Bild: <span x-text="image.id"
		</article>
	</dialog>
</body>

</html>